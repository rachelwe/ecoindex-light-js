function computeEcoIndex(e,o,r){const n=computeQuantile(quantiles_dom,e),t=computeQuantile(quantiles_req,o),i=computeQuantile(quantiles_size,r);return 100-5*(3*n+2*t+i)/6}function computeQuantile(e,o){for(i=1;i<e.length;i++)if(o<e[i])return i+(o-e[i-1])/(e[i]-e[i-1]);return e.length}function getEcoIndexGrade(e){return e>75?"A":e>65?"B":e>50?"C":e>35?"D":e>20?"E":e>5?"F":"G"}function computeGreenhouseGasesEmissionfromEcoIndex(e){return(2+2*(50-e)/100).toFixed(2)}function computeWaterConsumptionfromEcoIndex(e){return(3+3*(50-e)/100).toFixed(2)}quantiles_dom=[0,47,75,159,233,298,358,417,476,537,603,674,753,843,949,1076,1237,1459,1801,2479,594601],quantiles_req=[0,2,15,25,34,42,49,56,63,70,78,86,95,105,117,130,147,170,205,281,3920],quantiles_size=[0,1.37,144.7,319.53,479.46,631.97,783.38,937.91,1098.62,1265.47,1448.32,1648.27,1876.08,2142.06,2465.37,2866.31,3401.59,4155.73,5400.08,8037.54,223212.26],ecoindex=function(e,o){var r=req=error=0;o.forEach(function(e){req++;var o=0;0==e.transferSize?error++:o=e.transferSize,o=Math.round(o/1e3),r+=o});var n=100*error/req,t=computeEcoIndex(e,req,r),i=getEcoIndexGrade(t),a=computeGreenhouseGasesEmissionfromEcoIndex(t),d=computeWaterConsumptionfromEcoIndex(t),c="ecoIndex: "+t.toFixed(2)+(n>0?" (*"+Math.round(n)+"% d'erreur)":"")+" | GES: "+a+" gCO2e | eau: "+d+" cl | Nombre de requÃªtes: "+req+" | Taille de la page: "+r+" Ko | Taille du DOM: "+e,u=document.createElement("style");switch(document.head.appendChild(u),u.sheet.insertRule("#ecoindex { background: #ffffffcc; padding: 5px 8px; border-radius: 10px; position: fixed; z-index: 10; left: 10px; bottom: 10px;}"),u.sheet.insertRule("#ecoindex span { display: inline-block; width: 18px; height: 18px; font-size: 12px; line-height: 18px; margin: 0.1rem 0 0 0.5rem; text-align: center; border-radius: 50%; }"),gradeColor="#ED2124",textColor="#fff",i){case"A":gradeColor="#349A47";break;case"B":gradeColor="#51B84B";break;case"C":gradeColor="#CADB2A",textColor="#000";break;case"D":gradeColor="#F6EB15",textColor="#000";break;case"E":gradeColor="#FECD06",textColor="#000";break;case"F":gradeColor="#F99839";break;default:gradeColor="#ED2124"}u.sheet.insertRule("#ecoindex span { background-color: "+gradeColor+"; color: "+textColor+" }"),document.body.insertAdjacentHTML("beforeend",'<a href="http://www.ecoindex.fr/quest-ce-que-ecoindex/" id="ecoindex" target="_blank" title="'+c+'">ecoIndex<span>'+i+(n>0?"*":"")+"</span></a>")},window.onload=function(e){setTimeout(function(){var e=document.getElementsByTagName("*").length,o=window.performance.getEntriesByType("resource");o.push({name:"Page HTML",transferSize:window.performance.getEntriesByType("navigation")[0].transferSize}),ecoindex(e,o)},1e3)};